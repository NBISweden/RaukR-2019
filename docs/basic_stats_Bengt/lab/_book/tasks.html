<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lab: Basic Statistics | Models</title>
  <meta name="description" content="Lab: Basic Statistics | Models" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Lab: Basic Statistics | Models" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lab: Basic Statistics | Models" />
  
  
  

<meta name="author" content="Bengt Sennblad" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="final-words.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<link id="font-awesome-1-attachment" rel="attachment" href="libs/font-awesome-5.1.0/fonts/fontawesome-webfont.ttf"/>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="tasks.html"><a href="tasks.html"><i class="fa fa-check"></i><b>1</b> Tasks</a><ul>
<li class="chapter" data-level="1.1" data-path="tasks.html"><a href="tasks.html#task-simulation"><i class="fa fa-check"></i><b>1.1</b> Task | <code>Simulation</code></a><ul>
<li class="chapter" data-level="1.1.1" data-path="tasks.html"><a href="tasks.html#deterministic-model"><i class="fa fa-check"></i><b>1.1.1</b> Deterministic model</a></li>
<li class="chapter" data-level="1.1.2" data-path="tasks.html"><a href="tasks.html#statistical-model"><i class="fa fa-check"></i><b>1.1.2</b> Statistical model</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="tasks.html"><a href="tasks.html#task-probability-of-observed-data"><i class="fa fa-check"></i><b>1.2</b> Task | <code>Probability of observed data</code></a><ul>
<li class="chapter" data-level="1.2.1" data-path="tasks.html"><a href="tasks.html#simulation-solution"><i class="fa fa-check"></i><b>1.2.1</b> Simulation solution</a></li>
<li class="chapter" data-level="1.2.2" data-path="tasks.html"><a href="tasks.html#analytical-solution"><i class="fa fa-check"></i><b>1.2.2</b> Analytical solution</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="tasks.html"><a href="tasks.html#task-statistical-tests"><i class="fa fa-check"></i><b>1.3</b> Task | <code>Statistical tests</code></a><ul>
<li class="chapter" data-level="1.3.1" data-path="tasks.html"><a href="tasks.html#students-t-test"><i class="fa fa-check"></i><b>1.3.1</b> Student’s t-test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>2</b> Final words</a><ul>
<li class="chapter" data-level="2.1" data-path="final-words.html"><a href="final-words.html#types-of-models"><i class="fa fa-check"></i><b>2.1</b> Types of models</a></li>
<li class="chapter" data-level="2.2" data-path="final-words.html"><a href="final-words.html#types-of-statistical-tests"><i class="fa fa-check"></i><b>2.2</b> Types of statistical tests</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="session-info.html"><a href="session-info.html"><i class="fa fa-check"></i><b>3</b> Session info</a></li>
<li class="chapter" data-level="4" data-path="parameter-estimation-of-statistical-models.html"><a href="parameter-estimation-of-statistical-models.html"><i class="fa fa-check"></i><b>4</b> Parameter estimation of statistical models</a><ul>
<li class="chapter" data-level="4.1" data-path="parameter-estimation-of-statistical-models.html"><a href="parameter-estimation-of-statistical-models.html#bayesian-approach"><i class="fa fa-check"></i><b>4.1</b> Bayesian approach</a></li>
<li class="chapter" data-level="4.2" data-path="parameter-estimation-of-statistical-models.html"><a href="parameter-estimation-of-statistical-models.html#likelihood"><i class="fa fa-check"></i><b>4.2</b> Likelihood – The frequentist approach</a></li>
<li class="chapter" data-level="4.3" data-path="parameter-estimation-of-statistical-models.html"><a href="parameter-estimation-of-statistical-models.html#bayesians-vs-frequentists"><i class="fa fa-check"></i><b>4.3</b> Bayesians vs frequentists</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="overfitting.html"><a href="overfitting.html"><i class="fa fa-check"></i><b>5</b> Overfitting</a><ul>
<li class="chapter" data-level="5.1" data-path="overfitting.html"><a href="overfitting.html#overfitting-example-data"><i class="fa fa-check"></i><b>5.1</b> Overfitting | <code>Example data</code></a><ul>
<li class="chapter" data-level="5.1.1" data-path="overfitting.html"><a href="overfitting.html#task-simulation-of-example-data"><i class="fa fa-check"></i><b>5.1.1</b> Task | <code>simulation of example data</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="overfitting.html"><a href="overfitting.html#overfitting-model-comparison"><i class="fa fa-check"></i><b>5.2</b> Overfitting | <code>Model comparison</code></a><ul>
<li class="chapter" data-level="5.2.1" data-path="overfitting.html"><a href="overfitting.html#task-plot-two-likelihoods"><i class="fa fa-check"></i><b>5.2.1</b> Task | <code>plot two likelihoods</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="overfitting.html"><a href="overfitting.html#task-plot-all-likelihoods"><i class="fa fa-check"></i><b>5.2.2</b> Task | <code>plot all likelihoods</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regularization.html"><a href="regularization.html"><i class="fa fa-check"></i><b>6</b> Regularization</a><ul>
<li class="chapter" data-level="6.1" data-path="regularization.html"><a href="regularization.html#regularization-bayesian-interpretation"><i class="fa fa-check"></i><b>6.1</b> Regularization | <code>Bayesian interpretation</code></a></li>
<li class="chapter" data-level="6.2" data-path="regularization.html"><a href="regularization.html#regularization-aic-and-model-testing"><i class="fa fa-check"></i><b>6.2</b> Regularization | <code>AIC and model testing</code></a><ul>
<li class="chapter" data-level="6.2.1" data-path="regularization.html"><a href="regularization.html#task-aic-analysis"><i class="fa fa-check"></i><b>6.2.1</b> Task | <code>AIC analysis</code></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="regularization.html"><a href="regularization.html#regularization-lasso-and-feature-selection"><i class="fa fa-check"></i><b>6.3</b> Regularization | <code>LASSO and Feature selection</code></a><ul>
<li class="chapter" data-level="6.3.1" data-path="regularization.html"><a href="regularization.html#task-lasso-using-the-glmnet-r-package"><i class="fa fa-check"></i><b>6.3.1</b> Task | <code>Lasso using the glmnet R-package</code></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="regularization.html"><a href="regularization.html#cross-validation"><i class="fa fa-check"></i><b>6.4</b> Cross-validation</a><ul>
<li class="chapter" data-level="6.4.1" data-path="regularization.html"><a href="regularization.html#cross-validation-how-to-test-for-overfitting"><i class="fa fa-check"></i><b>6.4.1</b> Cross-validation | <code>How to test for overfitting</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="regularization.html"><a href="regularization.html#task-determine-optimal-lassolambdausing-cross-validation"><i class="fa fa-check"></i><b>6.4.2</b> Task | <code>Determine optimal LASSO</code><span class="math inline">\(\lambda\)</span><code>using cross-validation</code></a></li>
<li class="chapter" data-level="6.4.3" data-path="regularization.html"><a href="regularization.html#task-final-lasso-effect-sizes"><i class="fa fa-check"></i><b>6.4.3</b> Task| <code>Final LASSO effect sizes</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="session-info-1.html"><a href="session-info-1.html"><i class="fa fa-check"></i><b>7</b> Session info</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lab: Basic Statistics | <code>Models</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Lab: Basic Statistics | <code>Models</code></h1>
<h2 class="subtitle"><em>RaukR 2019 • Advanced R for Bioinformatics</em></h2>
<p class="author"><em>Bengt Sennblad</em></p>
</div>
<div id="tasks" class="section level1">
<h1><span class="header-section-number">1</span> Tasks</h1>
<div id="task-simulation" class="section level2">
<h2><span class="header-section-number">1.1</span> Task | <code>Simulation</code></h2>
<p>Here, we will generate a synthetic data set by simulating data from a linear model.</p>
<p><span class="math inline">\(Y = \beta_0 + \beta_1* X\)</span> is a <em>generating</em> model – it describes how to generate <span class="math inline">\(Y\)</span> from observed <span class="math inline">\(X\)</span> and parameters <span class="math inline">\(\beta_0,\beta_1\)</span>.</p>
<div id="deterministic-model" class="section level3">
<h3><span class="header-section-number">1.1.1</span> Deterministic model</h3>
<ul>
<li>Generate 100 samples of <span class="math inline">\(x,y\)</span> by
<ul>
<li>generate genotypes <span class="math inline">\(x\)</span> for each sample from a uniform distribution on integers <span class="math inline">\(0,1,2\)</span> (tip: use <code>runif</code>)</li>
<li>set <span class="math inline">\(\beta_0=0.3\)</span> and <span class="math inline">\(\beta_1=0.2\)</span></li>
<li>generate a phenotype <span class="math inline">\(y\)</span> for each sample of using the model <span class="math inline">\(y = \beta_0 + \beta_1* x\)</span></li>
<li>plot <span class="math inline">\(y\)</span> against <span class="math inline">\(x\)</span>.</li>
</ul></li>
</ul>
<div id="think-about" class="section level4">
<h4><span class="header-section-number">1.1.1.1</span> Think about</h4>
<ul>
<li>Does the plotted results look biologically reasonable?
<ul>
<li>if not: what could be the reason?</li>
</ul></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#parameters</span>
b0 =<span class="st"> </span><span class="fl">0.3</span>
b1 =<span class="st"> </span><span class="fl">0.2</span>
N=<span class="dv">100</span>
sim1 =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">round</span>(<span class="kw">runif</span>(N,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span><span class="dv">2</span>)))

sim1<span class="op">$</span>y =<span class="st"> </span>b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>sim1<span class="op">$</span>x

<span class="kw">plot</span>(<span class="dt">x=</span>sim1<span class="op">$</span>x, <span class="dt">y=</span>sim1<span class="op">$</span>y)</code></pre>
<details>
<p><summary> Some possible answers </summary></p>
<p><strong>Does the plot look biologically reasonable?</strong></p>
<ul>
<li>If you followed the formula <span class="math inline">\(y = \beta_0 + \beta_1* x\)</span> in the instructions literally, you end up with something like this</li>
</ul>
<p><img src="_main_files/figure-html/unnamed-chunk-4-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<ul>
<li>This means that you have effectively demonstrated what a <em>deterministic</em> model is and that is a good thing pedagoically :D</li>
<li>Notice that there are no variation in <span class="math inline">\(y\)</span> for each genotyp <span class="math inline">\(X\)</span>, this is not what we see in biological data.</li>
</ul>
Go on and read more below under <strong>Statistical model</strong>
</details>
</div>
</div>
<div id="statistical-model" class="section level3">
<h3><span class="header-section-number">1.1.2</span> Statistical model</h3>
<p><strong>Deterministic vs statistical models</strong></p>
<ul>
<li><span class="math inline">\(Y = \beta_0 + \beta_1* X\)</span> is a <em>deterministic</em> model
<ul>
<li>does not model any variation</li>
<li>Common, e.g., in classical physics (velocity <span class="math inline">\(v = \frac{\Delta x}{\Delta t}\)</span>)</li>
</ul></li>
<li><span class="math inline">\(Y = \beta_0 + \beta_1* X +\epsilon,\)</span> where <span class="math inline">\(\epsilon~\sim N(mean =0,sd=\sigma)\)</span> is a <em>statistical</em> (equiv. <em>stochastic</em>, <em>random</em>) linear model (<span class="math inline">\(\sim\)</span> means ‘<em>is drawn from</em>’)
<ul>
<li>attempts to model variation around a population mean (the <em>residuals</em>) determined by the model
<ul>
<li>the residual of sample <span class="math inline">\(i\)</span> is <span class="math inline">\(y_i-(\beta_0 + \beta_1* X)\)</span>.</li>
</ul></li>
<li>used in statistic analysis</li>
<li><span class="math inline">\(Y\)</span> is then called a stochastic or random variable</li>
</ul></li>
</ul>
<p>Henceforth, we will only consider <em>statistical</em> models.</p>
<p><strong>Task</strong></p>
<ul>
<li>Generate data from <span class="math inline">\(Y = \beta_0+ \beta_1* X +\epsilon,\)</span> where <span class="math inline">\(\epsilon ~\sim N(mean=0,sd = 0.05)\)</span> (tip: use <code>rnorm</code>).</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#parameters</span>
b0 =<span class="st"> </span><span class="fl">0.3</span>
b1 =<span class="st"> </span><span class="fl">0.2</span>
N=<span class="dv">100</span>
sim1 =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">round</span>(<span class="kw">runif</span>(N,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span><span class="dv">2</span>)))

sim1<span class="op">$</span>y =<span class="st"> </span>b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>sim1<span class="op">$</span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="fl">0.05</span>) 

<span class="kw">plot</span>(<span class="dt">x=</span>sim1<span class="op">$</span>x, <span class="dt">y=</span>sim1<span class="op">$</span>y)</code></pre>
<div id="think-about-1" class="section level4">
<h4><span class="header-section-number">1.1.2.1</span> Think about</h4>
<ul>
<li>Does the result look more biologically plausible?</li>
<li>When can simulated data be useful?</li>
</ul>
<details>
<p><summary> Some possible answers </summary></p>
<p><strong>Biologically plausible</strong></p>
<ul>
<li>Now we have some variation around the mean <span class="math inline">\(Y\)</span> for each genotype <span class="math inline">\(X\)</span>.</li>
<li>However,
<ul>
<li>we still cannot be sure that the arbitrarily chosen <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are correct and</li>
<li>maybe there are more variables (or <em>covariates</em>), affecting <span class="math inline">\(y\)</span>, that are not in the model.</li>
</ul></li>
<li><em>Always think about what the assumptions of the model is and if they are reasonable!</em></li>
</ul>
<p><strong>Uses for simulated data</strong></p>
<ul>
<li>Oracle knowledge when evaluating performance of methods, e.g., Type I and II errors</li>
<li>Estimating probabilities and probability distributions of, e.g., data and summary statistics of data (next task)</li>
</ul>
</details>
<hr />
</div>
</div>
</div>
<div id="task-probability-of-observed-data" class="section level2">
<h2><span class="header-section-number">1.2</span> Task | <code>Probability of observed data</code></h2>
<p>A (statistical) linear model, <span class="math inline">\(Y=\beta_0+\beta_1 X,\)</span> generates <span class="math inline">\(Y\)</span> given, or <em>conditioned</em> on, specified value of <span class="math inline">\(X\)</span>. Since we have variation in the model, we can’t say exactly what value <span class="math inline">\(Y\)</span> will be. Instead, we can compute or estimate the probability that <span class="math inline">\(Y\)</span> takes a specific value, say <span class="math inline">\(Y=y\)</span>, if we know that <span class="math inline">\(X\)</span> has a specific value, say <span class="math inline">\(X=x\)</span> (we say that the probaility is <em>conditioned</em> this value of <span class="math inline">\(X\)</span>). This will be a <em>conditional probability</em> <span class="math inline">\(Pr[Y=y|X=x]\)</span>, where the bar (‘<span class="math inline">\(|\)</span>’) means that the probability is conditioned on <span class="math inline">\(X=x\)</span>. In fact, if <span class="math inline">\(X\neq x\)</span> then this probability tells us nothing about <span class="math inline">\(Y\)</span>.</p>
<p>Our task here is to, for the linear model <span class="math display">\[Y=\beta_0+\beta_1 X\]</span> with parameters <span class="math inline">\((\beta_0=0.3, \beta_1=0.2, \sigma=0.05\)</span>), estimate the conditional probability <span class="math display">\[Pr[Y &lt;=0.65|X=2].\]</span></p>
<div id="simulation-solution" class="section level3">
<h3><span class="header-section-number">1.2.1</span> Simulation solution</h3>
<ul>
<li>simulate 1000 <span class="math inline">\(y\)</span> using the model above with <span class="math inline">\(x=2\)</span> and store in a vector <span class="math inline">\(Y\)</span>.</li>
<li>Make a histogram of <span class="math inline">\(Y\)</span> and estimate the probability that <span class="math inline">\(Y&lt;=0.65\)</span> (<em>tip</em>: make sure that <span class="math inline">\(0.65\)</span> is among to a histogram breakpoints)</li>
</ul>
<p><strong>Think About</strong></p>
<ul>
<li>What shape does the plotted histogram have?</li>
<li>Where approximately is the mean?</li>
<li>Does this make sense in light of the generative model we used?</li>
<li>Can we plot <span class="math inline">\(Pr[Y&lt;=y|X,\theta]\)</span> more directly? (tip: google, e.g., ‘probability distribution’)</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#parameters</span>
b0 =<span class="st"> </span><span class="fl">0.3</span>
b1 =<span class="st"> </span><span class="fl">0.2</span>
N =<span class="st"> </span><span class="dv">1000</span>
x =<span class="st"> </span><span class="dv">2</span>

y =<span class="st"> </span>b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="fl">0.05</span>) 

h=<span class="kw">hist</span>(y, <span class="dt">frequency=</span><span class="ot">TRUE</span>, <span class="dt">right=</span><span class="ot">FALSE</span>, <span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">1.0</span>, <span class="fl">0.05</span>), <span class="dt">plot=</span><span class="ot">FALSE</span>)
h<span class="op">$</span>counts =<span class="st"> </span>h<span class="op">$</span>counts<span class="op">/</span>N
<span class="kw">plot</span>(h, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.0</span>), <span class="dt">ylim =</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">labels=</span><span class="ot">TRUE</span>)

<span class="co"># compute requested probability from hist</span>
<span class="kw">paste</span>(<span class="st">&quot;Pr[Y&lt;=0.65|X=2] = &quot;</span>, <span class="kw">sum</span>(h<span class="op">$</span>counts[<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>]))</code></pre>
<details>
<p><summary> Some possible answers </summary></p>
<p><strong>Shape</strong></p>
<ul>
<li>The plot should be more or less bell-shaped (how well this show might depend on how many breaks you had for the histogram)</li>
</ul>
<p><strong>Mean</strong></p>
<ul>
<li>The mean appers to be approx 0.7</li>
</ul>
<p><strong>Makes sense?</strong></p>
<ul>
<li>A bell-shaped distribution is typical for the Normal distribution, which makes sense since the residuals are sampled from a normal distribution. However, in our simulation we used a <code>mean = 0</code>, and not <code>0.7</code> – how does this work?
<ul>
<li>The reason is that (<span class="math inline">\(\Leftrightarrow\)</span> means ‘is equivalent to’) <span class="math display">\[N(mean = \mu, sd =\sigma) \Leftrightarrow N(mean = 0, sd = \sigma) + \mu,\]</span> meaning that adding <span class="math inline">\(\mu\)</span> moves the whole distribution to a new mean <span class="math inline">\(=\mu\)</span>.
<ul>
<li>this means that our model can equivalently be written <span class="math inline">\(Y = N(\beta_0+\beta_1*X, \sigma)\)</span></li>
</ul></li>
</ul></li>
</ul>
<p><strong>What have we plotted; can we plot <span class="math inline">\(Pr[Y&lt;=y|X,\theta]\)</span> more directly?</strong></p>
<ul>
<li>We have plotted the distribution of interval probabilities of <span class="math inline">\(N(\beta_0+\beta_1*X, \sigma)\)</span>.</li>
<li>An important distribution in statistics is the distribution of the <em>cumulative distribution function (CDF)</em>, which is exactly the probability we estimated above, namely <span class="math inline">\(Pr[Y &lt;= y| \mu, \sigma]\)</span> for a normal distribution <span class="math inline">\(N(mean = \mu, sd=\sigma)\)</span>. The code below plots the estimated <em>CDF</em> from our simulation; notice the typical sigmoid shape.
<ul>
<li>From this distribution, we can directly read <span class="math inline">\(Pr[Y&lt;=0.65|X,\theta]\)</span> from the ppropriate bar.</li>
</ul></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#parameters</span>
b0 =<span class="st"> </span><span class="fl">0.3</span>
b1 =<span class="st"> </span><span class="fl">0.2</span>
N =<span class="st"> </span><span class="dv">1000</span>
x =<span class="st"> </span><span class="dv">2</span>

y =<span class="st"> </span>b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="fl">0.05</span>) 

h=<span class="kw">hist</span>(y, <span class="dt">frequency=</span><span class="ot">TRUE</span>, <span class="dt">right=</span><span class="ot">FALSE</span>, <span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">1.0</span>, <span class="fl">0.05</span>), <span class="dt">plot=</span><span class="ot">FALSE</span>)
h<span class="op">$</span>counts =<span class="st"> </span>h<span class="op">$</span>counts<span class="op">/</span>N

<span class="co"># replace the histogram counts with the cumulative counts</span>
h<span class="op">$</span>counts =<span class="st"> </span><span class="kw">cumsum</span>(h<span class="op">$</span>counts)
<span class="co">#plot the CDF</span>
<span class="kw">plot</span>(h, <span class="dt">labels=</span><span class="ot">TRUE</span>)

<span class="co"># compute requested probability from hist</span>
<span class="kw">paste</span>(<span class="st">&quot;Pr[Y&lt;=0.65|X=2] = &quot;</span>, <span class="kw">sum</span>(h<span class="op">$</span>counts[<span class="dv">13</span>]))</code></pre>
<pre><code>## [1] &quot;Pr[Y&lt;=0.65|X=2] =  0.145&quot;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-7-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<details>
<p><summary> Extra reading <em>The General Normal distribution</em> </summary></p>
<ul>
<li>Additionally, multiplying a normal distribution with <span class="math inline">\(\sigma\)</span> changes the ‘width’ of the distribution to have the satndard deviation <span class="math inline">\(\sigma\)</span>, meaning that we have <span class="math display">\[N(mean = \mu, sd =\sigma) \Leftrightarrow N(mean = 0, sd = 1)* \sigma + \mu, \]</span> something that is very much used in statistics
<ul>
<li>The distribution <span class="math inline">\(N(mean=0, sd=\sigma)\)</span> is called the <em>general normal distribution</em></li>
<li>Any variable <span class="math inline">\(Y\sim N(mean= \mu, sd=\sigma)\)</span> can therefore be transformed into a <em>Z-value</em>, <span class="math inline">\(Z=\frac{Y-\mu}{\sigma},\)</span> which has a general normal distribution, i.e., <span class="math inline">\(Z \sim N(mean=0, sd=1)\)</span>
</summary></li>
</ul></li>
</ul>
</details>
</div>
<div id="analytical-solution" class="section level3">
<h3><span class="header-section-number">1.2.2</span> Analytical solution</h3>
<ul>
<li>Conveniently, R has both the PDF and CDF implemented, making a</li>
<li>Calculate <span class="math inline">\(Pr[Y&lt;=0.65|X=2]\)</span> using R’s <em>cumulative distribution function (CDF)</em> for the Normal distribution (tip: look up help for <code>Normal</code>)
<ul>
<li>The <em>CDF</em> of the value <span class="math inline">\(y\)</span> is the probability that the stochastic variable <span class="math inline">\(Y&lt;=y\)</span>.</li>
</ul></li>
<li><em>Challenge</em>: try both approaches with other values of <span class="math inline">\(y\)</span> or try to compute <span class="math inline">\(Pr[Y&gt;y|X=2]\)</span>.</li>
</ul>
<p><strong>Think about</strong></p>
<ul>
<li>Do the result fit that from the Simulation?
<ul>
<li>If not, can make the fit better?</li>
</ul></li>
<li>What can this result be used for?</li>
<li><em>Challenge</em>: Why do we look at intervals of <span class="math inline">\(Y\)</span> rather than specific values?</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">b0 =<span class="st"> </span><span class="fl">0.3</span>
b1 =<span class="st"> </span><span class="fl">0.2</span>
x =<span class="st"> </span><span class="dv">2</span>
y =<span class="st"> </span><span class="fl">0.65</span>
mu =<span class="st"> </span>b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>x

<span class="kw">paste</span>(<span class="st">&quot;Pr[Y&lt;=.6|X=2] = &quot;</span>,<span class="kw">pnorm</span>(y, <span class="dt">mean =</span> mu, <span class="dt">sd=</span><span class="fl">0.05</span>))</code></pre>
<details>
<p><summary> Some possible answers </summary></p>
<ul>
<li>The result should fit quite well with that from the Simulation approach, given that precision obtained from the histogram
<ul>
<li>The precision can be improved with a higher sample size for the simulation</li>
</ul></li>
<li>The CDF, i.e., <span class="math inline">\(Pr[Y&lt;=y|X=2]\)</span>, is actually the basis for p-values. A <em>p-value</em> for an observation <span class="math inline">\(y\)</span> under a model is defined as the probability of generating <span class="math inline">\(y\)</span> or more extreme values from the model.
<ul>
<li>p-values can refer to different meanings of <em>extreme</em>. Using our model as an example NULL model:
<ul>
<li>For a <em>left-tailed</em> p-value, <span class="math inline">\(p(y) = Pr[Y&lt;=y|X=x]\)</span>, i.e., the <span class="math inline">\(CDF(y, \mu, \sigma)\)</span></li>
<li>For a <em>right-tailed</em> p-value, <span class="math inline">\(p(y) = Pr[Y&gt;=y|X=x]\)</span>, i.e., <span class="math inline">\(1-CDF(y, \mu, \sigma)\)</span></li>
<li>For a <em>double-tailed</em> p-value, <span class="math inline">\(p(y) = 2 \min\{Pr[Y&lt;=y|X=x],Pr[Y&gt;=y|X=x]\}\)</span></li>
</ul></li>
<li>If the p-value is <em>significant</em>, i.e., below some threshold <span class="math inline">\(\alpha\)</span> (typically <span class="math inline">\(\alpha = 0.05\)</span>) we can reject the NULL hypothesis that the data is generated from our model.</li>
<li>What was the left-tailed p-value for <span class="math inline">\(y=0.65\)</span> under our model and was that significant? What can we say about our model as a NULL model.</li>
</ul></li>
</ul>
<details>
<p><summary> Extra Reading <strong>Why probability of interval</strong> </summary></p>
<p>This is a bit tricky to explain.</p>
<ul>
<li>For discrete variable <span class="math inline">\(Y\)</span>, say heads or tails, we can compute an exact probability for, e.g. heads.</li>
<li>However, for continuous <span class="math inline">\(Y\)</span>, it is not possible compute the probability of an exact value of <span class="math inline">\(Y\)</span>, since exact must be defined using an inifite number of decimals. Thus, in effect makes <span class="math inline">\(Pr[Y] = 0\)</span>!
<ul>
<li>Hence, only intervals of continuous variables can be assigned proper probabilities.</li>
</ul></li>
<li>However, it is, in statistics, very convenient to be able to talk about and work with exact values <span class="math inline">\(Pr[Y=y]y\)</span> also for continuous variables.
<ul>
<li>If we reduce the interval centered around <span class="math inline">\(Y=y\)</span> decrementally and each time compute the mean probability over the histogram interval of intererest, we can get a better and better approximation of <span class="math inline">\(Pr[Y=y]\)</span>, we will in the limit end up with the <em>Probability density</em> of <span class="math inline">\(Y=y\)</span>.</li>
<li>The distribution of probability densities for <span class="math inline">\(Y\)</span> is called the <em>Probability density function</em> (PDF) of <span class="math inline">\(Y\)</span></li>
<li>Mathematically, the PDF can be viewed as the derivative of the CDF</li>
<li>Notice that the density of <span class="math inline">\(Y\)</span> is not a probability (e.g., it can be higher than 1.0). Sometimes this is marked by using a different notation for the density, e.g., <span class="math inline">\(f(Y)\)</span>; here however, we will use <span class="math inline">\(Pr[Y]\)</span> also for the density.</li>
</ul></li>
</ul>
</details>
<hr />
</details>
<hr />
</div>
</div>
<div id="task-statistical-tests" class="section level2">
<h2><span class="header-section-number">1.3</span> Task | <code>Statistical tests</code></h2>
<p>We will now consider an extension of the previous task to several data points. As you can imagine, doing this with the above approach could be cumbersome. Instead specific tests have been developed. We will here use the t-test as a very simple example.</p>
<div id="students-t-test" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Student’s t-test</h3>
<p>We will use a single sample t-test, which tests how probable it is that some sampled data is drawn from a given Normal distribution; this distribution is called the <em>NULL model</em> of the test. The t-test is not designed to handle different genotypes, so for simplicity, we will, again, limit ourselves to the case <span class="math inline">\(X=2\)</span>.</p>
<p>The t-test uses normalized residuals as a test statistics:</p>
<p><span class="math display">\[\begin{eqnarray*}
t  
&amp;= \sum_{i}\frac{y_i-\mu}{s/\sqrt{N}} 
&amp;= \frac{\bar{y}-\mu}{s/\sqrt{N}}
\end{eqnarray*}\]</span>
where <span class="math inline">\(s/\sqrt{N}\)</span> is an estimate of the standard deviation, <span class="math inline">\(\sigma\)</span>, from the observed data. As you can see this boils down to comparing the (standardized) estimated mean from the data, <span class="math inline">\(\bar{y}\)</span> and the model mean, <span class="math inline">\(\mu\)</span>.</p>
<ul>
<li><em>Challenge</em>: show the equality above`</li>
</ul>
<p>These normalized residuals are approximately distributed <span class="math inline">\(t~\sim N(0,1)\)</span> (this is the <em>General Normal distribution</em>, see also ‘Possible answers/Extra Reading’ under <a href="tasks.html#simulation-solution">1.2.1</a>)</p>
<p>Conveniently, The t-test is implemented in the R function <code>t.test</code></p>
<ul>
<li>Simulate a new data set from a linear model <span class="math inline">\(Y&#39; = \gamma_0 + \gamma_1 X&#39;\)</span>, for <span class="math inline">\(X&#39;=2\)</span> for all samples.
<ul>
<li>For simplicity, we will limit ourselves to the case <span class="math inline">\(X&#39;=2\)</span></li>
</ul></li>
<li>Use our previous model <span class="math inline">\(Y=\beta_0+\beta_1 X\)</span> as the NULL model.
<ul>
<li>Perform a one sample t-test (with <span class="math inline">\(\mu\)</span> from the NULL model) on new <span class="math inline">\(Y&#39;\)</span> data.</li>
</ul></li>
<li>Try some different values of <span class="math inline">\((\gamma_0, \gamma_1)\)</span> closer or further away from <span class="math inline">\((\beta_0, \beta_1)\)</span></li>
</ul>
<p><strong>Think about</strong></p>
<ul>
<li>Does the t-test reject the NULL model or not?</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># compute the mean, mu, from our model </span>
b0 =<span class="st"> </span><span class="fl">0.3</span>
b1 =<span class="st"> </span><span class="fl">0.2</span>

mu =<span class="st"> </span>b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>x

<span class="co"># Let&#39;s simulate the data from another model</span>
c0 =<span class="st"> </span><span class="fl">0.4</span>
c1 =<span class="st"> </span><span class="fl">0.2</span>
N=<span class="dv">100</span>
yp =<span class="st"> </span>c0 <span class="op">+</span><span class="st"> </span>c1 <span class="op">*</span><span class="st"> </span><span class="kw">rep</span>(x,N) <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="fl">0.05</span>) 
<span class="co"># t-test</span>
<span class="kw">t.test</span>(yp, <span class="dt">mu=</span>mu)</code></pre>
<details>
<p><summary> Some possible answers </summary>
* The <em>t</em>-test appears quite sensitive, especially for changes of <span class="math inline">\(\gamma_1\)</span> (<code>c_1</code>)</p>
<p><strong>The <em>t</em>-test can also be applied to other questions</strong></p>
<ul>
<li>Test if two samples are generated by the same (unknown) model using the standardized difference in means, typically, using the NULL hypothesis that this difference is 0. Example code below</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># data 1</span>
b0 =<span class="st"> </span><span class="fl">0.3</span>
b1 =<span class="st"> </span><span class="fl">0.2</span>
N=<span class="dv">100</span>
y =<span class="st"> </span>b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span><span class="kw">rep</span>(x,N) <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="fl">0.05</span>) 

<span class="co">#data 2</span>
c0 =<span class="st"> </span><span class="fl">0.4</span>
c1 =<span class="st"> </span><span class="fl">0.2</span>
N=<span class="dv">100</span>
yp =<span class="st"> </span>c0 <span class="op">+</span><span class="st"> </span>c1 <span class="op">*</span><span class="st"> </span><span class="kw">rep</span>(x,N) <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="fl">0.05</span>) 

<span class="kw">t.test</span>(y,yp)</code></pre>
<ul>
<li>Test if estimated parameters in a linear model are significantly different from 0 (see code). Example code below</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># reuse previously simulated data in sim1</span>
b0 =<span class="st"> </span><span class="fl">0.3</span>
b1 =<span class="st"> </span><span class="fl">0.2</span>
N=<span class="dv">100</span>
sim1 =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">round</span>(<span class="kw">runif</span>(N,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span><span class="dv">2</span>)))
sim1<span class="op">$</span>y =<span class="st"> </span>b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>sim1<span class="op">$</span>x

<span class="kw">summary</span>(<span class="kw">lm</span>(y<span class="op">~</span>x, <span class="dt">data=</span>sim1))</code></pre>
</details>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="final-words.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
